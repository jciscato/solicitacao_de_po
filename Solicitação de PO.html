<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Solicitação de PO</title>

	<style>
		body {
			width: 98.5vw;
			height: 98vh;
			justify-self: center;
		}

		.cabecalho {
			display: flex;
			white-space: nowrap;
		}

		.cabecalho p {
			font-family: "Courier New";
			font-size: 4.5em;
			margin-top: 4%;
			margin-bottom: 2.3%;
			width: 100%;
			color: black;
			text-align: center;
		}

		.filtros {
			justify-self: center;
			width: 95%;
			justify-content: space-evenly;
			padding-bottom: 1.5%;
		}
		
		.filtros tr {
			width: 100%;
			display: flex;
			justify-content: space-between;
		}

		.filtros td select, .filtros td input, .filtros td p{
			width: 20vw;
			text-align: center;
			appearance: none;
		}

		.filtros p {
			text-align: center;
			font-family: Arial, Helvetica, sans-serif;
			color: black;
		}
		
		.enviar {
			display: flex;
			justify-content: center;
			align-content: center;
			width: 100%;
			max-height: 10em;
		}
		
		.enviar button {
			background-color: #d3d3d3;
			margin: 2.5em;
			width: 20%;
			height: 3em;
			text-align: center;
			text-decoration: none;
			font-family: Arial, Helvetica, sans-serif;
			color: #333333;
			border-radius: 18px;
			font-size: 20px;
			cursor: pointer;
		}
		
		.enviar button:hover {
			background-color: #bababa;
			color: black;
			border-radius: 15px;
		}

		.formularios {
			display: flex;
			justify-content: center;
			width: 95%;
			justify-self: center;
			flex-direction: column;
			margin-top: 3%;
		}

		.nfnd, .danfe {
			width: 100%;
			min-height: 10vh;
			text-align: center;
			align-content: center;
			display: none;
			justify-content: space-evenly;
			justify-self: center;
		}

		.formnf, .formdanfe {
			width: 100%;
			display: flex;
			justify-content: center;
		}

		.formnf input, .formnf select, .formdanfe input, .formdanfe select {
			width: 85%;
			text-align: center;
			appearance: none;
			margin-bottom: 1em;
		}
		.formnf input::-webkit-outer-spin-button, .formnf input::-webkit-inner-spin-button, .formdanfe input::-webkit-outer-spin-button, .formdanfe input::-webkit-inner-spin-button, .vendor_extra_cod input::-webkit-outer-spin-button, .vendor_extra_cod input::-webkit-inner-spin-button {
			-webkit-appearance: none;
		}

		.formdanfe td p {
			width: 12.5vw;
		}

		input, select {
			border: none;
			border-bottom: 2px solid gray;
			border-bottom-left-radius: 15%;
			border-bottom-right-radius: 15%;
		}
		
		.vendor_extra_nome_titulo, .vendor_extra_nome, .vendor_extra_cod_titulo, .vendor_extra_cod {
			display: none;
		}

		.vendor_extra_nome_titulo strong, .vendor_extra_cod_titulo strong {
			color: red;
		}
		
	</style>
	
</head>

<body>
	<header>
		<div class="cabecalho">
			<p><strong>SOLICITAÇÃO DE PO</strong></p>
		</div>	
	</header>

	<main>

		<table class="filtros"> <!--FILTROS-->
			<tr>
				<td><p><strong>FORNECEDOR</strong></p></td>
				<td class="vendor_extra_nome_titulo" id="vendor_extra_nome_titulo"><p><strong>VENDOR EXTRA</strong></p></td>
				<td class="vendor_extra_cod_titulo" id="vendor_extra_cod_titulo"><p><strong>CÓD. VENDOR EXTRA</strong></p></td>
				<td><p><strong>PAGAMENTO</strong></p></td>
				<td><p><strong>TIPO DE RECEBIMENTO</strong></p></td>
			</tr>
			<tr>
				<td>
					<select name="fornecedores" id="fornecedores" onclick="fornecedorextra()">
						<option value="none" selected disabled>-- Selecione --</option>
						<!-- <option value="OTHER">-- VENDOR FORA DA LISTA --</option> -->
						<option value="AZ4">AZ4</option>
						<option value="BCD TRAVEL">BCD TRAVEL</option>
						<option value="BRANDWORKS">BRANDWORKS</option>
						<option value="BRAVIUM">BRAVIUM</option>
						<option value="CWT">CWT</option>
						<option value="FOUR LIVE">FOUR LIVE</option>
						<option value="HH PRINT">HH PRINT</option>
						<option value="INCENTIVALE">INCENTIVALE</option>
						<option value="MUNDIAL">MUNDIAL</option>
						<option value="PLUG">PLUG</option>
						<option value="VIDI">VIDI</option>
						<option value="VINDI">VINDI</option>
					</select>
				</td>
				<td class="vendor_extra_nome" id="vendor_extra_nome">
					<input type="text">
				</td>
				<td class="vendor_extra_cod" id="vendor_extra_cod">
					<input type="number">
				</td>
				<td>
					<select name="peps" id="peps">
						<option value="none" selected disabled>-- Selecione --</option>
						<option id="1758565200 - OVH">RENATA --- 1758565200</option>
						<option id="J-175825BR04BR/DE/VD/GR">FLAVIA --- J-175825BR04BR/DE/VD/GR</option>
						<option id="K-175825BR04BR/VS/GT/PV">FLAVIA --- K-175825BR04BR/VS/GT/PV</option>
						<option id="K-175825BR04BR/VS/GT/AG">FLAVIA --- K-175825BR04BR/VS/GT/AG</option>
						<option id="K-175825BR04RS/TE/GT/TC">SÂMEA --- K-175825BR04RS/TE/GT/TC</option>
						<option id="K-175825BR04BR/TE/GT/VA">SÂMEA --- K-175825BR04BR/TE/GT/VA</option>
						<option id="K-175825BR04BR/TE/GT/ID">SÂMEA --- K-175825BR04BR/TE/GT/ID</option>
					</select>
				</td>
				<td>
					<select name="recebimento" id="recebimento">
						<option value="none" selected disabled>-- Selecione --</option>
						<option value="NF/ND">SERVIÇO E DÉBITO</option>
						<option value="DANFE">PRODUTO</option>
					</select>
				</td>
			</tr>
		</table>

		<section class="formularios">

			<div class="nfnd" id="mod1">
				<table class="formnf">
					<tr> <!--CABEÇALHO-->
						<td><p>TIPO DE SERVIÇO</p></td>
						<td><p>NOME DO ITEM</p></td>
						<td><p>VALOR</p></td>
						<td><p>CÓDIGO DE SERVIÇO</p></td>
					</tr>
					<tr> <!--LINHA 1-->
						<td>
							<select name="nfnd_tipo_1" id="nfnd_tipo_1">
								<option value="none" selected disabled>-- Selecione --</option>
								<option value="Serviço">SERVIÇO</option>
								<option value="Débito">DÉBITO</option>
							</select>
						</td>
						<td><input id="nfnd_nome_1" type="text"></td>
						<td><input id="nfnd_tt_1" type="number"></td>
						<td><input id="nfnd_cod_1" type="text"></td>
					</tr>
					<tr> <!--LINHA 2-->
						<td>
							<select name="nfnd_tipo_2" id="nfnd_tipo_2">
								<option value="none" selected disabled>-- Selecione --</option>
								<option value="Serviço">SERVIÇO</option>
								<option value="Débito">DÉBITO</option>
							</select>
						</td>
						<td><input id="nfnd_nome_2" type="text"></td>
						<td><input id="nfnd_tt_2" type="number"></td>
						<td><input id="nfnd_cod_2" type="text"></td>
					</tr>
					<tr> <!--LINHA 3-->
						<td>
							<select name="nfnd_tipo_3" id="nfnd_tipo_3">
								<option value="none" selected disabled>-- Selecione --</option>
								<option value="Serviço">SERVIÇO</option>
								<option value="Débito">DÉBITO</option>
							</select>
						</td>
						<td><input id="nfnd_nome_3" type="text"></td>
						<td><input id="nfnd_tt_3" type="number"></td>
						<td><input id="nfnd_cod_3" type="text"></td>
					</tr>
					<tr> <!--LINHA 4-->
						<td>
							<select name="nfnd_tipo_4" id="nfnd_tipo_4">
								<option value="none" selected disabled>-- Selecione --</option>
								<option value="Serviço">SERVIÇO</option>
								<option value="Débito">DÉBITO</option>
							</select>
						</td>
						<td><input id="nfnd_nome_4" type="text"></td>
						<td><input id="nfnd_tt_4" type="number"></td>
						<td><input id="nfnd_cod_4" type="text"></td>
					</tr>
					<tr> <!--LINHA 5-->
						<td>
							<select name="nfnd_tipo_5" id="nfnd_tipo_5">
								<option value="none" selected disabled>-- Selecione --</option>
								<option value="Serviço">SERVIÇO</option>
								<option value="Débito">DÉBITO</option>
							</select>
						</td>
						<td><input id="nfnd_nome_5" type="text"></td>
						<td><input id="nfnd_tt_5" type="number"></td>
						<td><input id="nfnd_cod_5" type="text"></td>
					</tr>
				</table>

			</div>

			<div class="danfe" id="mod2">
				<table class="formdanfe">
					<tr> <!--CABEÇALHO-->
						<td><p>NCM</p></td>
						<td><p>NOME DO ITEM</p></td>
						<td><p>QTD.</p></td>
						<td><p>VALOR UNITÁRIO</p></td>
						<td><p>VALOR TOTAL</p></td>
						<td><p>% ICMS</p></td>
						<td><p>% IPI</p></td>
					</tr>
					<tr> <!--LINHA 1-->
						<td><input type="text" id="danfe_ncm_1"></td>
						<td><input type="text" id="danfe_nome_1"></td>
						<td><input type="number" id="danfe_qtd_1"></td>
						<td><input type="number" id="danfe_uni_1"></td>
						<td><input type="number" id="danfe_tt_1" placeholder="Cálculo Automático" readonly></td>
						<td><input type="number" id="danfe_icms_1"></td>
						<td><input type="number" id="danfe_ipi_1"></td>
					</tr>
					<tr> <!--LINHA 2-->
						<td><input type="text" id="danfe_ncm_2"></td>
						<td><input type="text" id="danfe_nome_2"></td>
						<td><input type="number" id="danfe_qtd_2"></td>
						<td><input type="number" id="danfe_uni_2"></td>
						<td><input type="number" id="danfe_tt_2" placeholder="Cálculo Automático" readonly></td>
						<td><input type="number" id="danfe_icms_2"></td>
						<td><input type="number" id="danfe_ipi_2"></td>
					</tr>				
					<tr> <!--LINHA 3-->
						<td><input type="text" id="danfe_ncm_3"></td>
						<td><input type="text" id="danfe_nome_3"></td>
						<td><input type="number" id="danfe_qtd_3"></td>
						<td><input type="number" id="danfe_uni_3"></td>
						<td><input type="number" id="danfe_tt_3" placeholder="Cálculo Automático" readonly></td>
						<td><input type="number" id="danfe_icms_3"></td>
						<td><input type="number" id="danfe_ipi_3"></td>
					</tr>				
					<tr> <!--LINHA 4-->
						<td><input type="text" id="danfe_ncm_4"></td>
						<td><input type="text" id="danfe_nome_4"></td>
						<td><input type="number" id="danfe_qtd_4"></td>
						<td><input type="number" id="danfe_uni_4"></td>
						<td><input type="number" id="danfe_tt_4" placeholder="Cálculo Automático" readonly></td>
						<td><input type="number" id="danfe_icms_4"></td>
						<td><input type="number" id="danfe_ipi_4"></td>
					</tr>				
					<tr> <!--LINHA 5-->
						<td><input type="text" id="danfe_ncm_5"></td>
						<td><input type="text" id="danfe_nome_5"></td>
						<td><input type="number" id="danfe_qtd_5"></td>
						<td><input type="number" id="danfe_uni_5"></td>
						<td><input type="number" id="danfe_tt_5" placeholder="Cálculo Automático" readonly></td>
						<td><input type="number" id="danfe_icms_5"></td>
						<td><input type="number" id="danfe_ipi_5"></td>
					</tr>				
				</table>
			</div>

		</section>

		<div class="enviar"> <!--BOTÃO ENVIAR-->
			<button onclick="abrir()"><strong>ENVIAR</strong></button>
		</div>

	</main>



<script>	
	document.getElementById("recebimento").addEventListener("click", formulario);

	document.getElementById("danfe_uni_1").addEventListener("change", danfe1);
	document.getElementById("danfe_qtd_1").addEventListener("change", danfe1);
	document.getElementById("danfe_uni_2").addEventListener("change", danfe2);
	document.getElementById("danfe_qtd_2").addEventListener("change", danfe2);
	document.getElementById("danfe_uni_3").addEventListener("change", danfe3);
	document.getElementById("danfe_qtd_3").addEventListener("change", danfe3);
	document.getElementById("danfe_uni_4").addEventListener("change", danfe4);
	document.getElementById("danfe_qtd_4").addEventListener("change", danfe4);
	document.getElementById("danfe_uni_5").addEventListener("change", danfe5);
	document.getElementById("danfe_qtd_5").addEventListener("change", danfe5);

    function abrir(){
		// VARS GERAIS
		var rec = document.getElementById("recebimento").value;
		var forn = document.getElementById("fornecedores").value;
		var peps = document.getElementById("peps").value;

		// VARS PARA EMAIL
		var sub = "Requisição de PO: "+rec+" --- "+forn;

		var linha_break = "%0D%0A----------------------------------------------------------------------------------------------------------------------------%0D%0A";
		
		var nfnd_head = "TIPO      |      NOME      |      VALOR      |      CÓDIGO"+linha_break;
		var nfnd_1 = document.getElementById("nfnd_tipo_1").value+"  |  "+document.getElementById("nfnd_nome_1").value+"  |  "+document.getElementById("nfnd_tt_1").value+"  |  "+document.getElementById("nfnd_cod_1").value+linha_break;
		var nfnd_2 = document.getElementById("nfnd_tipo_2").value+"  |  "+document.getElementById("nfnd_nome_2").value+"  |  "+document.getElementById("nfnd_tt_2").value+"  |  "+document.getElementById("nfnd_cod_2").value+linha_break;
		var nfnd_3 = document.getElementById("nfnd_tipo_3").value+"  |  "+document.getElementById("nfnd_nome_3").value+"  |  "+document.getElementById("nfnd_tt_3").value+"  |  "+document.getElementById("nfnd_cod_3").value+linha_break;
		var nfnd_4 = document.getElementById("nfnd_tipo_4").value+"  |  "+document.getElementById("nfnd_nome_4").value+"  |  "+document.getElementById("nfnd_tt_4").value+"  |  "+document.getElementById("nfnd_cod_4").value+linha_break;
		var nfnd_5 = document.getElementById("nfnd_tipo_5").value+"  |  "+document.getElementById("nfnd_nome_5").value+"  |  "+document.getElementById("nfnd_tt_5").value+"  |  "+document.getElementById("nfnd_cod_5").value+linha_break;
		
		var danfe_head = "NCM      |      NOME      |      QTD.      |      UNI.      |      VALOR      |      ICMS      |      IPI"+linha_break;
		var danfe_1 = document.getElementById("danfe_ncm_1").value+"  |  "+document.getElementById("danfe_nome_1").value+"  |  "+document.getElementById("danfe_qtd_1").value+"  |  "+document.getElementById("danfe_uni_1").value+"  |  "+document.getElementById("danfe_tt_1").value+"  |  "+document.getElementById("danfe_icms_1").value+"%  |  "+document.getElementById("danfe_ipi_1").value+"%"+linha_break;
		var danfe_2 = document.getElementById("danfe_ncm_2").value+"  |  "+document.getElementById("danfe_nome_2").value+"  |  "+document.getElementById("danfe_qtd_2").value+"  |  "+document.getElementById("danfe_uni_2").value+"  |  "+document.getElementById("danfe_tt_2").value+"  |  "+document.getElementById("danfe_icms_2").value+"%  |  "+document.getElementById("danfe_ipi_2").value+"%"+linha_break;
		var danfe_3 = document.getElementById("danfe_ncm_3").value+"  |  "+document.getElementById("danfe_nome_3").value+"  |  "+document.getElementById("danfe_qtd_3").value+"  |  "+document.getElementById("danfe_uni_3").value+"  |  "+document.getElementById("danfe_tt_3").value+"  |  "+document.getElementById("danfe_icms_3").value+"%  |  "+document.getElementById("danfe_ipi_3").value+"%"+linha_break;
		var danfe_4 = document.getElementById("danfe_ncm_4").value+"  |  "+document.getElementById("danfe_nome_4").value+"  |  "+document.getElementById("danfe_qtd_4").value+"  |  "+document.getElementById("danfe_uni_4").value+"  |  "+document.getElementById("danfe_tt_4").value+"  |  "+document.getElementById("danfe_icms_4").value+"%  |  "+document.getElementById("danfe_ipi_4").value+"%"+linha_break;
		var danfe_5 = document.getElementById("danfe_ncm_5").value+"  |  "+document.getElementById("danfe_nome_5").value+"  |  "+document.getElementById("danfe_qtd_5").value+"  |  "+document.getElementById("danfe_uni_5").value+"  |  "+document.getElementById("danfe_tt_5").value+"  |  "+document.getElementById("danfe_icms_5").value+"%  |  "+document.getElementById("danfe_ipi_5").value+"%"+linha_break;
		

		// LIMPEZA DE LINHAS VAZIAS
		if (rec == "NF/ND" && document.getElementById("nfnd_nome_1").value=="") {
			nfnd_1 = "";}
		if (rec == "NF/ND" && document.getElementById("nfnd_nome_2").value=="") {
			nfnd_2 = "";}
		if (rec == "NF/ND" && document.getElementById("nfnd_nome_3").value=="") {
			nfnd_3 = "";}
		if (rec == "NF/ND" && document.getElementById("nfnd_nome_4").value=="") {
			nfnd_4 = "";}
		if (rec == "NF/ND" && document.getElementById("nfnd_nome_5").value=="") {
			nfnd_5 = "";}

		if (rec == "DANFE" && document.getElementById("danfe_nome_1").value=="") {
			danfe_1 = "";}
		if (rec == "DANFE" && document.getElementById("danfe_nome_2").value=="") {
			danfe_2 = "";}
		if (rec == "DANFE" && document.getElementById("danfe_nome_3").value=="") {
			danfe_3 = "";}
		if (rec == "DANFE" && document.getElementById("danfe_nome_4").value=="") {
			danfe_4 = "";}
		if (rec == "DANFE" && document.getElementById("danfe_nome_5").value=="") {
			danfe_5 = "";}

		var nfnd_body = nfnd_head+nfnd_1+nfnd_2+nfnd_3+nfnd_4+nfnd_5;
		var danfe_body = danfe_head+danfe_1+danfe_2+danfe_3+danfe_4+danfe_5;

		// DEFINIÇÃO DO TIPO DE BODY
		if (rec == "NF/ND") {
			var body = "REQUISIÇÃO DE PO%0D%0A%0D%0AFORNECEDOR: "+forn+"%0D%0APEP: "+peps+"%0D%0A%0D%0A"+nfnd_body;
		} else {
			var body = "REQUISIÇÃO DE PO%0D%0A%0D%0AFORNECEDOR: "+forn+"%0D%0APEP: "+peps+"%0D%0A%0D%0A"+danfe_body;
		}
	   	
		// ENVIO DO EMAIL
		if (rec == "none" || forn == "none" || peps == "none") {		// CHECK INICIAL - PREENCHIMENTO FILTROS INICIAIS
			alert("Por favor, preencha as informações necessárias de FORNECEDOR, PAGAMENTO ou RECEBIMENTO");
		} else {
			window.open("mailto:julio.ciscato@pmi.com?subject="+sub+"&body="+body);
	    }
	}

	function formulario(){
		var rec = document.getElementById("recebimento").value;

		if (rec == "NF/ND") {
			document.getElementById("mod1").style.display = "flex";
			document.getElementById("mod2").style.display = "none";
		} else if (rec == "DANFE") {
			document.getElementById("mod1").style.display = "none";
			document.getElementById("mod2").style.display = "flex";
		} else {
			document.getElementById("mod1").style.display = "none";
			document.getElementById("mod2").style.display = "none";
		}
	}

	function danfe1(){
		var qtd = document.getElementById("danfe_qtd_1").value;
		var uni = document.getElementById("danfe_uni_1").value;
		var multi = (qtd*uni);
		document.getElementById("danfe_tt_1").value = multi.toFixed(2);
	}
	function danfe2(){
		var qtd = document.getElementById("danfe_qtd_2").value;
		var uni = document.getElementById("danfe_uni_2").value;
		var multi = (qtd*uni);
		document.getElementById("danfe_tt_2").value = multi.toFixed(2);
	}
	function danfe3(){
		var qtd = document.getElementById("danfe_qtd_3").value;
		var uni = document.getElementById("danfe_uni_3").value;
		var multi = (qtd*uni);
		document.getElementById("danfe_tt_3").value = multi.toFixed(2);
	}
	function danfe4(){
		var qtd = document.getElementById("danfe_qtd_4").value;
		var uni = document.getElementById("danfe_uni_4").value;
		var multi = (qtd*uni);
		document.getElementById("danfe_tt_4").value = multi.toFixed(2);
	}
	function danfe5(){
		var qtd = document.getElementById("danfe_qtd_5").value;
		var uni = document.getElementById("danfe_uni_5").value;
		var multi = (qtd*uni);
		document.getElementById("danfe_tt_5").value = multi.toFixed(2);
	}

	function fornecedorextra(){
		if (document.getElementById("fornecedores").value == "OTHER") {
			document.getElementById("vendor_extra_nome").style.display = "flex";
			document.getElementById("vendor_extra_cod").style.display = "flex";
			document.getElementById("vendor_extra_nome_titulo").style.display = "flex";
			document.getElementById("vendor_extra_cod_titulo").style.display = "flex";
		} else {
			document.getElementById("vendor_extra_nome").style.display = "none";
			document.getElementById("vendor_extra_cod").style.display = "none";
			document.getElementById("vendor_extra_nome_titulo").style.display = "none";
			document.getElementById("vendor_extra_cod_titulo").style.display = "none";			
		}
	}

</script>

</body>
</html>